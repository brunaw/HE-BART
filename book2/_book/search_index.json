[
["index.html", "Mixed BART Models: maths and discussion Chapter 1 Intro", " Mixed BART Models: maths and discussion Bruna Wundervald 2021-02-05 Chapter 1 Intro This documents works as a summary of our work towards building a “Mixed model” style BART. All the maths in detail will be written here, as well as our simulation results. "],
["model.html", "Chapter 2 Model 2.1 Maths", " Chapter 2 Model Define the following model. Suppose we have the observation of a tree node as: \\[y_{ij}, i = 1,\\ldots,n_j, \\; j = 1\\ldots, m\\] where \\(y_{ij}\\) is observation \\(i\\) in group \\(j\\). There are different numbers of observations \\(n_j\\) in each group, so for example \\(n_1\\) is the number of observations in group 1, etc. There are \\(m\\) groups. The total number of observations is \\(n = \\sum_{j=1}^m n_j\\) Then, for each tree node, suppose we have the likelihood: \\[y_{ij} \\sim N(\\mu_j, \\tau^{-1})\\] so each group has an overall mean \\(\\mu_j\\), with an overall precision term \\(\\tau\\). We then have a hierarchical prior distribution: \\[\\mu_j \\sim N(\\mu, k(\\tau^{-1}))\\] where \\(k\\) will be taken as a constant for simplicity, and the hyper-parameter prior distributions are: \\[\\mu \\sim N(0, \\tau_\\mu)\\] \\[\\tau \\sim Ga(\\alpha, \\beta)\\] Where the values \\(\\tau_\\mu, \\alpha, \\beta\\) are all fixed. 2.1 Maths The likelihood of each tree node will be: \\[\\begin{equation} L = \\prod_{j = 1}^{m} \\prod_{i = 1}^{n_j} p(y_{ij} | \\mu_{j}, \\tau) \\\\ L \\propto \\tau^{n/2} exp \\{ -\\frac{\\tau}{2} \\sum_{j = 1}^{m} \\sum_{i = 1}^{n_j} (y_{ij} - \\mu_j)^2 \\} \\end{equation}\\] with prior distributions: \\(\\mu_j | \\mu, \\tau, k\\) \\[\\begin{equation} p(\\mu_1, \\dots, \\mu_m | \\mu, \\omega) \\propto (\\tau/k)^{m/2} exp\\{ - \\frac{\\tau}{2k} \\sum_{j = 1}^{m} (\\mu_j - \\mu)^2 \\} \\end{equation}\\] \\(\\tau | \\alpha, \\beta\\) \\[p(\\tau | \\alpha, \\beta) \\propto \\tau^{\\alpha - 1} exp\\{ - \\beta \\tau \\}\\] \\(\\mu | \\tau_{\\mu}\\) \\[\\begin{equation} p(\\mu | \\tau_{\\mu}) \\propto \\tau_{\\mu}^{1/2} exp\\{ - \\frac{ \\tau_{\\mu}}{2} \\mu^2 \\} \\end{equation}\\] and their joint distribution as: \\(p(\\tau, \\mu_1, \\dots, \\mu_m, \\mu| y, k, \\tau_{\\mu}, \\alpha, \\beta)\\) \\[\\begin{equation} p(\\tau, \\mu_1, \\dots, \\mu_m, \\mu| y, k, \\tau_{\\mu}, \\alpha, \\beta) \\propto \\tau^{\\alpha - 1} exp\\{ - \\beta \\tau \\} \\times \\\\ (\\tau/k)^{m/2} exp\\{ - \\frac{\\tau}{2k} \\sum_{j = 1}^{m} (\\mu_j - \\mu)^2 \\} \\\\ \\times \\tau_{\\mu}^{1/2} exp\\{ - \\frac{ \\tau_{\\mu}}{2} \\mu^2 \\} \\times \\tau^{n/2} exp \\{ -\\frac{\\tau}{2} \\sum_{j = 1}^{m} \\sum_{i = 1}^{n_j} (y_{ij} - \\mu_j)^2 \\} \\end{equation}\\] "],
["posteriors.html", "Chapter 3 Posteriors 3.1 Posterior for \\(\\tau\\) 3.2 Posterior for \\(\\mu_j\\) 3.3 Posterior for \\(\\mu\\)", " Chapter 3 Posteriors 3.1 Posterior for \\(\\tau\\) \\(p(\\tau | \\mu_1, \\dots, \\mu_m, y, \\alpha, \\beta, k)\\) \\[\\begin{equation} p(\\tau | \\mu_1, \\dots, \\mu_m, y, \\alpha, \\beta) \\propto \\tau^{\\alpha - 1} exp\\{ - \\beta \\tau \\} \\times \\\\ (\\tau/k)^{m/2} exp \\{ -\\frac{\\tau}{2k} \\sum_{j = 1}^{m} (\\mu_{j} - \\mu)^2 \\} \\times \\\\ \\tau^{n/2} exp \\{ -\\frac{\\tau}{2} \\sum_{j = 1}^{m} \\sum_{i = 1}^{n_j} (y_{ij} - \\mu_j)^2 \\} \\\\ \\propto \\tau^{n/2 + m/2 + \\alpha - 1 } exp \\{ - \\tau \\Big( \\frac{\\sum_{j = 1}^{m} \\sum_{i = 1}^{n_j} (y_{ij} - \\mu_j)^2}{2} + \\beta + \\frac{\\sum_{j = 1}^{m}(\\mu_{j} - \\mu)^2}{2k} \\Big) \\} \\end{equation}\\] So \\(\\tau | \\mu_1, \\dots, \\mu_m, y, \\alpha, \\beta, k \\sim \\text{Gamma}(n/2 + m/2 + \\alpha, \\Big( \\frac{\\sum_{j = 1}^{m} \\sum_{i = 1}^{n_j} (y_{ij} - \\mu_j)^2}{2} + \\beta + \\frac{\\sum_{j = 1}^{m}(\\mu_{j} - \\mu)^2}{2k} \\Big))\\) 3.2 Posterior for \\(\\mu_j\\) \\[\\begin{equation} Q = (\\tau/k) \\sum_{j=1}^{m} (\\mu_j - \\mu)^2 + \\tau \\sum_{j = 1}^{m} \\sum_{i = 1}^{n_j} (y_{ij} - \\mu_j)^2 \\\\ Q = \\tau [ \\sum_{j = 1}^{m} n_j \\mu_j^2 + \\frac{\\mu_j^2}{k} - (\\sum_{j = 1}^{m} \\frac{2 \\mu \\mu_j}{k} + 2 \\bar y_j n_j \\mu_j)] \\\\ Q \\propto \\tau [ \\sum_{j = 1}^{m} (n_j + \\frac{1}{k}) \\mu_j^2 - 2 \\mu_j (\\frac{\\mu}{k} + \\bar y_j n_j )] \\\\ Q \\propto [ \\sum_{j = 1}^{m} (n_j + \\frac{1}{k})(\\mu_j - \\frac{\\mu/k + \\bar y_j n_j}{n_j + 1/k})^2]\\\\ \\end{equation}\\] So for each \\(\\mu_j\\) \\[\\mu_j | \\mu, y, \\tau, k \\sim N(\\frac{\\mu/k + \\bar y_j n_j}{n_j + 1/k}, (n_j + \\frac{1}{k})^{-1} \\tau)\\] 3.3 Posterior for \\(\\mu\\) Similarly, for \\(\\mu\\) we have: \\[\\begin{equation} Q = \\frac{\\tau}{k} \\sum_{j = 1}^{m} (\\mu_j - \\mu)^2 + \\tau_{\\mu}\\mu^2 \\\\ Q = \\frac{\\tau}{k} \\sum_{j=1}^{m} (\\mu_j^{2} - 2 \\mu \\mu_j + \\mu^2) + \\tau_{\\mu} \\mu^2 \\\\ Q \\propto (\\tau_{\\mu} + \\frac{\\tau}{k} m ) \\mu^2 - \\frac{2\\tau}{k} \\sum_{j=1}^{m} \\mu \\mu_j \\\\ Q \\propto (\\tau_{\\mu} + \\frac{\\tau}{k} m ) \\mu^2 - \\frac{2\\tau}{k} \\mu \\bar \\mu m \\\\ Q \\propto (\\tau_{\\mu} + \\frac{\\tau}{k} m )(\\mu - \\frac{(\\tau/k) \\bar \\mu m}{\\tau_{\\mu} + \\frac{\\tau}{k} m})^2 \\end{equation}\\] So for \\(\\mu\\) we have that the conditional distribution: \\[\\mu | \\mu_1, \\dots, \\mu_{m}, \\mu_{\\mu}, \\tau_{\\mu}, k \\sim N( \\frac{(\\tau/k) \\bar \\mu m}{\\tau_{\\mu} + \\frac{\\tau}{k} m}, (\\tau_{\\mu} + \\frac{\\tau}{k} m )^{-1})\\] "],
["conditional-distributions.html", "Chapter 4 Conditional Distributions", " Chapter 4 Conditional Distributions \\[y_{ij} \\sim N(\\lambda_j, \\tau^{-1})\\] \\[\\lambda_j \\sim N(\\mu, k\\tau^{-1})\\] \\[\\mu \\sim N(\\mu_\\mu,\\tau_\\mu^{-1})\\] \\[\\tau \\sim Ga(\\alpha, \\beta)\\] with \\(N = \\sum_{j = 1}^{m} n_j\\). Define \\(\\mathbf{M}\\) to be an \\(N\\times m\\) binary matrix which allocates each observation to a group. Writing things out in matrix format: \\[\\begin{equation} \\boldsymbol{y} = \\begin{bmatrix} y_{11} \\\\ y_{21} \\\\ \\vdots \\\\ y_{n_m m} \\end{bmatrix} \\end{equation}\\] \\[\\begin{equation} \\boldsymbol{M} = \\begin{bmatrix} 0 &amp; 1 &amp; 0 \\\\ 1 &amp; 0 &amp; 0 \\\\ 1 &amp; 0 &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots \\\\ 0 &amp; 0 &amp; 1 \\end{bmatrix} \\end{equation}\\] \\[\\begin{equation} \\boldsymbol{\\lambda} = \\begin{bmatrix} \\lambda_1 \\\\ \\vdots \\\\ \\lambda_m \\end{bmatrix} \\end{equation}\\] then \\(\\boldsymbol{y} \\sim MVN_{N}( \\boldsymbol{M \\lambda}, \\tau^{-1} \\boldsymbol{I})\\) and \\(\\boldsymbol{\\lambda} \\sim MVN_{m}( \\mu \\boldsymbol{1}, k \\tau^{-1} \\boldsymbol{I})\\). \\[\\begin{equation} E[\\boldsymbol{y} | \\mu, \\tau] = E_\\lambda E_y[\\boldsymbol{y} | \\boldsymbol{\\lambda}, \\mu, \\tau] = \\boldsymbol{M} E[\\boldsymbol{\\lambda}] = \\mu \\boldsymbol{M1} \\\\ Var[\\boldsymbol{y} | \\mu, \\tau] = Var[\\boldsymbol{M} \\boldsymbol{\\lambda}] + \\tau^{-1} \\boldsymbol{I} = \\boldsymbol{M} \\boldsymbol{M}^{T}(k\\tau^{-1}) + \\tau^{-1} \\boldsymbol{I} \\end{equation}\\] so \\[\\boldsymbol{y} | \\mu, \\tau, k, \\tau_{\\mu} \\sim MVN_{N}(\\mu \\boldsymbol{M1} , \\boldsymbol{M} \\boldsymbol{M}^{T}(k\\tau^{-1}) + \\tau^{-1} \\boldsymbol{I})\\] \\[\\boldsymbol{y} | \\mu, \\tau, k, \\tau_{\\mu} \\sim MVN_{N}(\\mu \\boldsymbol{M1} , k\\tau^{-1} + \\tau^{-1} \\boldsymbol{I}), \\text{ since } \\boldsymbol{M} \\boldsymbol{M}^{T} = \\boldsymbol{I}\\] \\[\\boldsymbol{y} | \\mu, \\tau, k, \\tau_{\\mu} \\sim MVN_{N}(\\mu \\boldsymbol{M1} , \\tau^{-1} (k + \\boldsymbol{I}) )\\] We now use this as the starting point and integrate out \\(\\mu\\) and \\(\\tau\\). The equation we end up with should be a function of \\(M\\), \\(k\\), \\(\\tau_\\mu\\), \\(\\alpha\\), and \\(\\beta\\). To start, define: \\(\\Psi = (k + \\boldsymbol{I})\\) so that \\(y|\\ldots \\sim MVN(\\mu \\boldsymbol{M1}, \\tau^{-1} \\boldsymbol{\\Psi})\\). Then we obtain: \\[\\begin{eqnarray*} \\pi(y | k, \\tau_\\mu, \\mu_\\mu, \\alpha, \\beta) &amp;=&amp; \\int \\int \\tau^{\\alpha - 1} \\exp [ -\\beta \\tau] \\times \\tau_\\mu^{1/2} \\exp \\left[ -\\frac{\\tau_\\mu}{2} (\\mu - \\mu_\\mu)^2 \\right]\\\\ &amp;\\times&amp; \\tau^{N/2} |\\Psi|^{-1/2} \\exp \\left[ -\\frac{\\tau}{2} \\left\\{ (\\boldsymbol{y} - \\mu \\boldsymbol{M1})^T \\boldsymbol{\\Psi}^{-1} (\\boldsymbol{y} - \\mu \\boldsymbol{M1}) \\right\\} \\right] \\partial\\mu \\partial\\tau \\\\ &amp;=&amp; \\int \\tau^{\\alpha - 1} \\exp [ -\\beta \\tau] \\times \\tau_\\mu^{1/2} \\tau^{N/2} |\\Psi|^{-1/2}\\partial\\tau \\\\ &amp;\\times&amp; \\int \\exp \\left[ -\\frac{1}{2} [\\tau_\\mu (\\mu - \\mu_\\mu)^2 + \\tau (\\boldsymbol{y} - \\mu \\boldsymbol{M1})^T \\boldsymbol{\\Psi}^{-1} (\\boldsymbol{y} - \\mu \\boldsymbol{M1})] \\right] \\partial\\mu \\\\ \\end{eqnarray*}\\] The inner expression can be rewritten as: \\[\\begin{eqnarray*} Q &amp;=&amp; [\\tau_\\mu (\\mu - \\mu_\\mu)^2 + \\tau (\\boldsymbol{y} - \\mu \\boldsymbol{M1})^T \\boldsymbol{\\Psi}^{-1} (\\boldsymbol{y} - \\mu \\boldsymbol{M1})] \\\\ &amp;=&amp; \\mu^2(\\tau_{\\mu} + \\tau (\\boldsymbol{M1})^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1}) - 2\\mu (\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1}) + \\tau_{\\mu} \\mu_{\\mu}^2 + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} \\\\ &amp;=&amp; \\mu^2(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1}) - 2\\mu (\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1}) + \\tau_{\\mu} \\mu_{\\mu}^2 + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} \\\\ &amp;=&amp; \\tau_{\\mu} \\mu_{\\mu}^2 + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + (\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1}) \\left(\\mu - \\frac{\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1}}{\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1}}\\right)^2 \\\\ &amp;+&amp; \\frac{(\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1})^2}{(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})}\\\\ \\end{eqnarray*}\\] that can be be plugged back into our equation as a \\(\\text{Normal}(\\frac{\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1}}{(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})}, (\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})^{-1})\\): \\[\\begin{eqnarray*} \\pi(y | k, \\tau_\\mu, \\mu_\\mu, \\alpha, \\beta) &amp;=&amp; \\int \\tau^{\\alpha - 1} \\exp [ -\\beta \\tau] \\times \\tau_\\mu^{1/2} \\tau^{N/2} |\\Psi|^{-1/2}\\partial\\tau \\\\ &amp;\\times&amp; \\int \\exp \\left[ -\\frac{1}{2} [\\tau_\\mu (\\mu - \\mu_\\mu)^2 + \\tau (\\boldsymbol{y} - \\mu \\boldsymbol{M1})^T \\boldsymbol{\\Psi}^{-1} (\\boldsymbol{y} - \\mu \\boldsymbol{M1})] \\right] \\partial\\mu \\\\ &amp;=&amp; \\int \\tau^{\\alpha - 1} \\exp [ -\\beta \\tau] \\times \\tau_\\mu^{1/2} \\tau^{N/2} |\\Psi|^{-1/2}\\partial\\tau \\exp \\left[ -\\frac{1}{2}\\{ \\tau_{\\mu} \\mu_{\\mu}^2 + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y}\\} \\right] \\\\ &amp;\\times&amp; \\exp \\left[ -\\frac{1}{2} \\left \\{ \\frac{(\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1})^2}{(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1})} \\right \\} \\right]\\\\ &amp;\\times&amp; \\int \\exp \\left[ -\\frac{1}{2} [ (\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}) \\left(\\mu - \\frac{\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1}}{\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}}\\right)^2 \\right] \\\\ &amp;\\times&amp; \\frac{(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})^{1/2}}{(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1})^{1/2}} \\thinspace \\thinspace \\thinspace \\partial\\mu \\\\ &amp;=&amp; \\int \\tau^{\\alpha - 1} \\exp [ -\\beta \\tau] \\times \\tau_\\mu^{1/2} \\tau^{N/2} |\\Psi|^{-1/2} \\exp \\left[ -\\frac{1}{2}\\{ \\tau_{\\mu} \\mu_{\\mu}^2 + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y}\\} \\right] \\\\ &amp;\\times&amp; \\exp \\left[ -\\frac{1}{2} \\left \\{ \\frac{(\\tau_{\\mu} \\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi} ^{-1} \\boldsymbol{M1})^2}{(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})} \\right \\} \\right] \\frac{1}{(\\tau_{\\mu} + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1})^{1/2}} \\thinspace \\thinspace \\thinspace \\partial\\tau \\\\ \\end{eqnarray*}\\] Now, replacing \\(\\tau_{\\mu} = k \\tau\\), we have: \\[\\begin{eqnarray*} \\pi(y | k, \\tau_\\mu, \\mu_\\mu, \\alpha, \\beta) &amp;=&amp; \\int \\tau^{\\alpha - 1} \\exp [ -\\beta \\tau] \\times (k \\tau)^{1/2} \\tau^{N/2} |\\Psi|^{-1/2} \\exp \\left[ -\\frac{1}{2}\\{ k \\tau\\mu_{\\mu}^2 + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y}\\} \\right] \\\\ &amp;\\times&amp; \\exp \\left[ -\\frac{1}{2} \\left \\{ \\frac{(k \\tau\\mu_{\\mu} + \\tau \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})^2}{(k \\tau + \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})} \\right \\} \\right] \\frac{1}{(k \\tau+ \\tau \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})^{1/2}} \\thinspace \\thinspace \\thinspace \\partial\\tau \\\\ &amp;=&amp; |\\Psi|^{-1/2} k^{1/2} \\int \\tau^{\\alpha - 1} \\tau^{1/2} \\tau^{N/2} \\exp [ -\\beta \\tau] \\times \\exp \\left[ -\\frac{\\tau}{2}\\{ k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y}\\} \\right] \\\\ &amp;\\times&amp; \\exp \\left[ -\\frac{1}{2} \\left \\{ \\frac{(\\tau (k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{M1}))^2}{ (\\tau (k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}\\boldsymbol{1})} \\right \\} \\right] \\frac{1}{(\\tau (k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1} \\boldsymbol{1}))^{1/2}} \\thinspace \\thinspace \\thinspace \\partial\\tau \\\\ &amp;=&amp; |\\Psi|^{-1/2} k^{1/2} \\frac{1}{(k + \\boldsymbol{1}^{T} \\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})^{1/2}} \\int \\tau^{\\alpha - 1} \\tau^{N/2} \\\\ &amp;\\times&amp; \\exp [ -\\beta \\tau] \\times \\exp \\left[ -\\frac{\\tau}{2}\\{ k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + \\frac{(k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1}\\boldsymbol{M1})^2}{k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}} \\} \\right] \\thinspace \\thinspace \\partial\\tau \\\\ &amp;=&amp; |\\Psi|^{-1/2} k^{1/2} \\frac{1}{(k + \\boldsymbol{1}^{T} \\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})^{1/2}} \\int \\tau^{N/2 + \\alpha - 1} \\\\ &amp;\\times&amp; \\exp [ -\\tau \\{ \\beta + \\frac{1}{2}(k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + \\frac{(k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1}\\boldsymbol{M1})^2}{k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}} ) \\}] \\thinspace \\thinspace \\partial\\tau \\\\ \\end{eqnarray*}\\] where the main expression can be seen as a \\(\\text{Gamma}(N/2 + \\alpha, \\beta + \\frac{1}{2}(k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + \\frac{(k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{1})^2}{k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}} ))\\) and: \\[\\begin{eqnarray*} \\pi(y | k, \\tau_\\mu, \\mu_\\mu, \\alpha, \\beta) &amp;=&amp; |\\Psi|^{-1/2} k^{1/2} \\frac{1}{(k + \\boldsymbol{1}^{T} \\boldsymbol{\\Psi}^{-1}\\boldsymbol{1})^{1/2}} \\int \\tau^{N/2 + \\alpha - 1} \\\\ &amp;\\times&amp; \\exp [ -\\tau \\{ \\beta + \\frac{1}{2}(k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + \\frac{(k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1}\\boldsymbol{M1})^2}{k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}} ) \\}] \\thinspace \\thinspace \\\\ &amp;\\times&amp; \\frac{ (\\beta + \\frac{1}{2}(k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + \\frac{(k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1}\\boldsymbol{M1})^2}{k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}}))^{N/2 + \\alpha} }{ (\\beta + \\frac{1}{2}(k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + \\frac{(k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1}\\boldsymbol{M1})^2}{k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}}))^{N/2 + \\alpha} } \\partial\\tau \\\\ &amp;=&amp; |\\Psi|^{-1/2} k^{1/2} \\frac{1}{k + (\\boldsymbol{1}^{T} \\boldsymbol{\\Psi}^{-1}\\boldsymbol{1})^{1/2}} \\\\ &amp;\\times&amp; (\\beta + \\frac{1}{2}(k \\mu_{\\mu}^2 + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1} \\boldsymbol{y} + \\frac{(k \\mu_{\\mu} + \\boldsymbol{y}^T \\boldsymbol{\\Psi}^{-1}\\boldsymbol{M1})^2}{k + \\boldsymbol{1}^{T}\\boldsymbol{\\Psi}^{-1}\\boldsymbol{1}}))^{-(N/2 + \\alpha)}\\\\ \\end{eqnarray*}\\] "],
["checking-posteriors-by-simulation.html", "Chapter 5 Checking posteriors by simulation 5.1 ‘High’ k: 2.5 5.2 ‘Small’ k: 0.5 5.3 \\(y | k, \\tau_{\\mu}, \\mu_{\\mu}, \\alpha, \\beta\\): Likelihood profiles for k, \\(\\mu_{\\mu}\\) and \\(\\beta\\) 5.4 Code", " Chapter 5 Checking posteriors by simulation On this section, we have the results for the posterior calculations using the expressions found previously in this document. The posterior density values are calculated using simulated values, in the same maths structure described in the “Maths” section. In all plots, the dashed red lines represent the ‘true’ values for each parameter. Ideally, these values should maximize the posteriors. If that happens we can be more sure that our calculations are correct. The fixed parameters are \\(\\alpha = 0.5\\), \\(\\beta = 1\\), \\(\\mu_{\\mu} = 0.5\\) and \\(\\tau_{\\mu} = 0.5\\) 5.1 ‘High’ k: 2.5 This first plot is just a summary of the distribution of the simulated data, using 9 groups The posterior for \\(\\tau\\) seem to have maximum at a value very close to the ‘true’ \\(\\tau\\) (used to simulated the data) For both \\(\\mu\\) and \\(\\mu_j\\), that doesn’t happen as we wanted, and the maxima are not so close to the original values Index Posterior average True mu 1 -2.546 -2.584 2 0.058 0.043 3 -0.667 -0.599 4 -2.439 -2.353 5 5.139 5.196 6 -2.429 -2.402 7 1.918 1.695 8 0.459 0.491 9 -0.765 -0.771 5.2 ‘Small’ k: 0.5 Index Posterior average True mu 1 -0.592 -0.639 2 -0.115 -0.113 3 -0.307 -0.242 4 -0.617 -0.592 5 0.818 0.917 6 -0.635 -0.602 7 0.337 0.217 8 -0.058 -0.024 9 -0.290 -0.276 5.3 \\(y | k, \\tau_{\\mu}, \\mu_{\\mu}, \\alpha, \\beta\\): Likelihood profiles for k, \\(\\mu_{\\mu}\\) and \\(\\beta\\) 5.4 Code Find the latest version at https://github.com/brunaw/mixed_bart/blob/master/code/simulation_MB/MB_math_check.R "],
["parameter-change.html", "Chapter 6 Parameter change", " Chapter 6 Parameter change https://brunaw.shinyapps.io/BHM_parameters "],
["references.html", "References", " References "]
]
